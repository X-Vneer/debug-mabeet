import{r as R}from"./index.0b2a3d34.js";import{g as C,a,b as B}from"./index.e77bb1b1.js";import{u as G}from"./useFetcher.eba3529e.js";import{M as E}from"./MainLoader.0b1e9c65.js";import{D as M}from"./DatePickerComponent.7a33aeae.js";import{u as m}from"./index.64890424.js";import{s as j}from"./shallow.9563ddbe.js";import{M as _}from"./MainBtn.613ab098.js";import{u as k}from"./useBusyDays.68dd123a.js";import{j as e}from"./jsx-runtime.32b752e4.js";import{n as F}from"./events.f9ec1bb8.js";import{M as I}from"./Text.5b63783a.js";import"./index.6a506d10.js";import"./index.413c1286.js";import"./index.1c0a9886.js";import"./index.8844c111.js";import"./Loader.9f91644a.js";import"./DatePickerInput.961328e7.js";import"./Transition.fdec9ac0.js";import"./use-input-props.c60d46d4.js";import"./Input.styles.becb1a1b.js";import"./CloseButton.50a20970.js";import"./ActionIcon.a2eaccaa.js";import"./UnstyledButton.7b2d4165.js";import"./use-merged-ref.d4736d19.js";import"./Overlay.0fbfbb1d.js";import"./get-default-z-index.b47c3510.js";import"./Popover.bb8b8da1.js";import"./index.9dee6ded.js";import"./Portal.c9ae93e7.js";import"./Input.9c23a1cb.js";import"./ChevronIcon.e00c8a6a.js";const fe=()=>{const{isLoading:$,error:A,data:o}=m(s=>s.unitData);let[x,r,n]=C(["id","from","to"]);r=r||a(new Date),n=n||a(new Date(new Date().setDate(new Date().getDate()+1)));const[i,p]=m(s=>[s.dates,s.setDates],j),{busyDays:h,handleStartDateChange:f,error:g,isLoading:y}=k({id:x,initialDate:r}),w=s=>{const c=B(s[0],s[1]);if(h.find((L,P)=>c.includes(L))){F.show({color:"red",title:"عذرا لايمكنك الحجز",message:"يوجد ايام محجوزة مسبقا في الايام المختارة, يمكن تجربة اختيار ايام اخرى"});return}p(()=>({dates:s}))};R.useEffect(()=>{p(()=>({dates:[new Date(r),new Date(n)]}))},[]);const u=`/units/${x}/availability?from=${a(i[0])}&to=${a(i[1])}`,{data:t,isLoading:D,error:b}=G({reqKey:i[1]?u:null,url:u,options:{headers:{"Accept-Language":"ar-SA,ar;q=0.9"}}}),{showReservation:l,setShowReservation:N,setShowLogin:v}=m(s=>({showReservation:s.showReservation,setShowReservation:s.setShowReservation,setShowLogin:s.setShowLogIn}),j),S=()=>{if(window.localStorage.getItem("mabeet-user")){N(!0);return}v(s=>({showLogin:!0}))};return e.jsxs(e.Fragment,{children:[e.jsx(I,{theme:{dir:"rtl",colors:{brand:["#eee","#49bfb6","#49bfb6","#49bfb6","#49bfb6","#49bfb6","#49bfb6","#49bfb6","#C50E82","#49bfb6"]},primaryColor:"brand"},children:e.jsx("div",{style:{boxShadow:"rgba(0, 0, 0, 0.08) 0px 20px 64px"},className:"mx-auto border border-[#ccc] pb-6  rounded-[20px]",children:D?e.jsx("div",{className:"flex items-center  justify-center min-h-[590px]",children:e.jsx(E,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 border-b text-textGray   border-b-[#eee]",children:[e.jsxs("p",{className:"pb-2",children:[e.jsx("span",{className:"text-mainColor",children:t?.price}),"/ ليلة"]}),e.jsxs("p",{children:["أجمالي ",e.jsx("span",{children:t?.duration_count})," ",e.jsx("span",{className:"text-mainColor font-semibold ",children:t?.final})]})]}),e.jsxs("div",{className:"flex  justify-between px-6 py-5 text-sm",children:[e.jsx("span",{children:t?.duration_count}),l?null:e.jsx("span",{children:"بإمكانك تعديل التاريخ"})]}),g||b?e.jsxs("p",{className:"text-sm py-10 text-center text-red-600",children:["Something Wrong happend!",e.jsx("br",{}),"try to reload the page",e.jsx("br",{}),e.jsx("span",{className:"text-sm",children:b?.response?.data?.errors})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-5 px-6 border-b border-b-[#eee] reservation-calender",children:[e.jsx(M,{numberOfColumns:1,closeOnChange:!1,readonly:l,handleDateChange:f,value:i,isLoading:y,setValue:w,renderFun:s=>{const c=s.getDate(),d=h.includes(a(s));return e.jsxs("div",{className:` ${d?" opacity-50 ":""} `,children:[c," ",d&&e.jsx("span",{className:"absolute top-1 bottom-1 right-[18px] rotate-45 w-[1px] bg-textGray origin-center"})," "]})}}),e.jsxs("div",{className:"flex gap-4  pt-6",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"text-textGray font-medium  text-sm",children:"وقت الوصول"}),e.jsx("span",{children:o?.checkin})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"text-textGray font-medium  text-sm",children:"وقت المغادرة"}),e.jsx("span",{children:o?.checkout})]})]})]}),e.jsxs("div",{className:"p-6",children:[l?null:e.jsx(_,{onClick:S,type:"button",className:"font-medium w-full",children:"اختر"}),e.jsxs("p",{className:"text-center pt-2 text-sm font-medium text-textGray",children:["ستدفع الان ",e.jsx("span",{children:t?.down_payment})]})]})]}),e.jsxs("div",{className:"px-6 border-b border-[#eee]",children:[e.jsxs("div",{className:"flex justify-between pb-2 font-medium",children:[e.jsx("p",{children:t?.duration_count}),e.jsx("p",{children:t?.total})]}),e.jsxs("div",{className:"flex justify-between pb-2 text-sm ",children:[e.jsx("p",{children:"التامين"}),e.jsx("p",{className:"text-textGray",children:t?.insurance})]}),e.jsxs("div",{className:"flex justify-between pb-2 text-sm ",children:[e.jsx("p",{children:"رسوم الخدمة"}),e.jsx("p",{className:"text-textGray",children:t?.customer_fees})]})]}),e.jsxs("div",{className:"flex justify-between py-2 px-6",children:[e.jsx("p",{children:"الإجمالي"}),e.jsx("p",{children:t?.final})]})]})})}),e.jsxs("div",{style:{boxShadow:"rgba(0, 0, 0, 0.08) 0px 20px 64px"},className:"mx-auto border border-[#ccc] mt-6 rounded-[20px] bg-white text-center py-6",children:[e.jsx("p",{className:"text-lg font-medium mb-3",children:"الخريطة"}),e.jsx("a",{className:"text-blue-500 hover:text-blue-700 duration-200",target:"_blank",rel:"noopener",href:o?.location,children:"عرض الخريطة"})]})]})};export{fe as default};
